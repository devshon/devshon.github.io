---
layout: single
title: "AWS 배포 나의 경험"
categories: BackEnd
tag: [total, aws, ec2, rds, error]
---

# 시작하기 앞서

> AWS 배포 후 기억에 오래 남기기 위해서 AWS 배포와 나의 생각을 작성할 것이다.

# AWS 종류

### EC2 (elastic compute cloud)

> 몇분안에 구동 가능한 가상 서버

### VPC (virtual private cloud)

> aws 네트워크 망안에 사용자 전용 사설 네트워크 망

### S3 (simple storage service)

> 파일 업로드 및 공유

### ELB (elastic load balancing)

> 서버로 들어오는 트래픽을 골고루 여러개의 머신으로 전달

### RDS

> 분산 관계형 데이터베이스이다 MySQL, MongoDB 등과 같은 데이터 베이스를 제공

# AWS (EC2, RDS)

> 기본을 웹 사이트를 배포하는데 사용하는 서버이다.
>
> 크게 본다면 EC2로 가상 서버를 만든 후 RDS 서버를 만들어 연동을 시켜주는 방식이다.
>
> 우선 가상 서버를 생성하기 전에 보안그룹을 생성한다.
>
> 이것은 security group 이라 말하고 규칙을 통해 인스턴스(가상서버)로 들어오고 나가는 트래픽을 세부적으로 제어할 수 있다.
>
> 예를 들면 22번 포트는 개발자 PC에서만 접근 가능하도록 할 수 있고 80번 포트는 모두에게 허용할 수 있도록 한다.
>
> 기본적으로 보안그룹은 리소스별로 생성했다. EC2 인스턴스의 보안그룹 1개와 RDS 보안그룹 1개로 총 2개의 보안그룹을 생성했다.
>
> 그림을 그려보자면

![screencapture-0017598](/Users/sonseongho/Library/Application Support/typora-user-images/screencapture-0017598.png)

> VPC (Virtual Private Cloud)는 가상의 네트워크에서 서버 리소스를 운영할 수 있는 기능을 제공한다.
>
> VPC 내부에 인스턴스를 담고있는 것이 보안그룹이다.
>
> 아까 말한대로 리소스의 특징끼리 보안그룹에 담고 있다. EC2 인스턴스는 가상 서버이기 때문에 IP를 갖게 되고 RDS는 가상 데이터베이스로 end-point로 연동을 하여 사용할 수 있다.
>
> EC2가 두개인 이유는 클라이언트에 폴더와 서버 폴더 각각 독립적인 인스턴스로 나눴기 때문이다.

# EC2 접근

> 인스턴스에 접근하기 위해선 key 파일이 필요하다.
>
> 아마도 key파일은 보안그룹을 생성할 때 만들 수 있다. key파일은 절때 잃어버려선 안되는 중요한 보안파일이다.
>
> 이것이 없다면 인스턴스에 접근할 수 있는 방법이 없다고 생각한다.

### 접근하기

> 나느 .pem 확장자의 키파일을 사용했다.
>
> 우선 키파일을 내 로컬 어딘가에 담고 터미널로 해당위치에 이동한다.
>
> 그 후 접근 명령어를 실행한다.

```bash
ssh -i <keyname>.pem ec2-user@<인스턴스 Public IP>
```

> 키파일로 나의 인스턴스로 접근 하게된다.
>
> 접근을 했다면 git clone을 통해서 가상서버로 올릴 파일을 가져온다.
>
> 가져온 후 내부에서 클라이언트, 서버 통신이 이뤄질 수 있도록 세팅을 한다.
>
> 그 후 빌드를 한다.
>
> 서버 인스턴스에는 연결되는 DB에 RDS의 end-point를 지정해준다.
>
> 최종적으로는 자바스크립트를 사용하는 나는 자바스크립트 런타임인 pm2를 사용하여 가상서버를 돌리게 되었다.

> 배포를 하면서 정말 많은 에러를 맞닥뜨렸다.
>
> 다양한 에러를 수정하면서 확실하게 수정하고 시도하는 법을 배웠고 가상 서버가 어떻게 돌아가는지 이해하게 된 것 같다.
>
> 한번에 잘 처리된 것보단 스트레스를 조금 받았지만 성취감과 이해도는 확실히 더해진 것 같다.
